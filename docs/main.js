(()=>{"use strict";var e={56:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},72:e=>{var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var i={},a=[],s=0;s<e.length;s++){var c=e[s],d=r.base?c[0]+r.base:c[0],l=i[d]||0,u="".concat(d," ").concat(l);i[d]=l+1;var p=n(u),h={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==p)t[p].references++,t[p].updater(h);else{var m=o(h,r);r.byIndex=s,t.splice(s,0,{identifier:u,updater:m,references:1})}a.push(u)}return a}function o(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var i=r(e=e||[],o=o||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var s=n(i[a]);t[s].references--}for(var c=r(e,o),d=0;d<i.length;d++){var l=n(i[d]);0===t[l].references&&(t[l].updater(),t.splice(l,1))}i=c}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},249:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(601),o=n.n(r),i=n(314),a=n.n(i)()(o());a.push([e.id,"body {\n  font-family: sans-serif;\n  margin: 0;\n  display: flex;\n  flex-direction: column;\n  min-height: 100vh;\n}\n\nheader, footer {\n  background-color: #333;\n  color: white;\n  padding: 1rem;\n}\n\nmain {\n  flex: 1;\n  padding: 1rem;\n}\n\n.skip-link {\n  position: absolute;\n  top: -40px;\n  left: 0;\n  background-color: #000;\n  color: white;\n  padding: 8px;\n  z-index: 100;\n}\n\n.skip-link:focus {\n  top: 0;\n}\n\n.story-list {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n    gap: 1rem;\n}\n\n.story-item {\n    border: 1px solid #ccc;\n    border-radius: 8px;\n    padding: 1rem;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n}\n\n.story-item img {\n    width: 100%;\n    height: 200px;\n    object-fit: cover;\n    border-radius: 4px;\n}\n\n.form-container {\n  max-width: 400px;\n  margin: 2rem auto;\n  padding: 2rem;\n  border: 1px solid #ccc;\n  border-radius: 8px;\n}\n\n.form-group {\n  margin-bottom: 1rem;\n}\n\n.form-group label {\n  display: block;\n  margin-bottom: 0.5rem;\n}\n\n.form-group input {\n  width: 100%;\n  padding: 0.5rem;\n  box-sizing: border-box;\n}\n\nbutton {\n  width: 100%;\n  padding: 0.75rem;\n  background-color: #333;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n}\n\nbutton:hover {\n  background-color: #555;\n}\n\n.camera-container {\n  position: relative;\n  width: 100%;\n  max-width: 500px;\n  margin: 0 auto 1rem;\n}\n\n#camera-feed, #photo-preview {\n  width: 100%;\n  height: auto;\n  border-radius: 8px;\n}\n\n.hidden {\n  display: none;\n}\n\n#capture-button {\n  margin-bottom: 1rem;\n}\n\n.leaflet-popup-content-wrapper {\n  border-radius: 8px;\n}\n\n.popup-content {\n  text-align: center;\n}\n\n.popup-content b {\n  display: block;\n  margin-top: 5px;\n}\n\n.popup-content p {\n  font-size: 0.9em;\n  margin: 5px 0 0 0;\n}\n\n.story-item--clickable {\n  transition: background-color 0.2s ease;\n}\n\n.story-item--clickable:hover {\n  cursor: pointer;\n  background-color: #f0f0f0;\n}\n\n",""]);const s=a},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n}).join("")},t.i=function(e,n,r,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(r)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(a[c]=!0)}for(var d=0;d<e.length;d++){var l=[].concat(e[d]);r&&a[l[0]]||(void 0!==i&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=i),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),o&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=o):l[4]="".concat(o)),t.push(l))}},t}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},601:e=>{e.exports=function(e){return e[1]}},659:e=>{var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={id:r,exports:{}};return e[r](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0;var r=n(72),o=n.n(r),i=n(825),a=n.n(i),s=n(659),c=n.n(s),d=n(56),l=n.n(d),u=n(540),p=n.n(u),h=n(113),m=n.n(h),g=n(249),f={};f.styleTagTransform=m(),f.setAttributes=l(),f.insert=c().bind(null,"head"),f.domAPI=a(),f.insertStyleElement=p(),o()(g.A,f),g.A&&g.A.locals&&g.A.locals;const y="https://story-api.dicoding.dev/v1",v=class{static async getAllStories(e){const t=await fetch(`${y}/stories`,{headers:{Authorization:`Bearer ${e}`}}),n=await t.json();if(n.error)throw new Error(n.message);return n.listStory}static async register(e){const t=await fetch(`${y}/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n=await t.json();if(n.error)throw new Error(n.message);return n}static async login(e){const t=await fetch(`${y}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n=await t.json();if(n.error)throw new Error(n.message);return n.loginResult}static async addNewStory(e){const t=localStorage.getItem("authToken");if(!t)throw new Error("User not authenticated");const n=await fetch(`${y}/stories`,{method:"POST",headers:{Authorization:`Bearer ${t}`},body:e}),r=await n.json();if(r.error)throw new Error(r.message);return r}static setAuthToken(e){localStorage.setItem("authToken",e)}static getAuthToken(){return localStorage.getItem("authToken")}static removeAuthToken(){localStorage.removeItem("authToken")}},w={register:async e=>v.register(e),async login(e){const t=await v.login(e);return v.setAuthToken(t.token),t},addNewStory:async e=>v.addNewStory(e),async getAllStories(){const e=v.getAuthToken();if(!e)throw new Error("User not authenticated");return v.getAllStories(e)},getAuthToken:()=>v.getAuthToken(),removeAuthToken(){v.removeAuthToken()}},b=class{constructor(e){this._container=e,this._map=null,this._markers={},this._onSaveClick=null}render(){this._container.innerHTML='<div class="content"> <h2>Peta Lokasi Cerita</h2> <div id="stories-map" style="height:400px;width:100%;margin-bottom:1rem"></div> <h2>Daftar Cerita</h2> <div id="story-list" class="story-list"> </div> </div>'}renderStoryList(e){const t=document.querySelector("#story-list");t.innerHTML="",e.forEach(e=>{const n=document.createElement("div");n.classList.add("story-item"),e.lat&&e.lon&&(n.dataset.id=e.id,n.dataset.lat=e.lat,n.dataset.lon=e.lon,n.classList.add("story-item--clickable")),n.innerHTML=`\n        <img src="${e.photoUrl}" alt="Foto cerita dari ${e.name}">\n        <h3>${e.name}</h3>\n        <p>${e.description}</p>\n        <small>Dibuat pada: ${new Date(e.createdAt).toLocaleDateString()}</small>\n        <button class="save-story-btn" data-id="${e.id}">Simpan Offline</button>\n      `,t.appendChild(n)}),this._onSaveClick&&document.querySelectorAll(".save-story-btn").forEach(t=>{t.addEventListener("click",()=>{const n=t.dataset.id,r=e.find(e=>e.id===n);r&&this._onSaveClick(r)})})}renderMap(e){const t=e.filter(e=>e.lat&&e.lon),n=document.querySelector("#stories-map");0!==t.length?(this._map=L.map("stories-map").setView([t[0].lat,t[0].lon],10),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap"}).addTo(this._map),t.forEach(e=>{const t=L.marker([e.lat,e.lon]).addTo(this._map);t.bindPopup(`\n        <div class="popup-content">\n          <img src="${e.photoUrl}" alt="${e.name}" style="width:100%; border-radius:4px;">\n          <b>${e.name}</b>\n          <p>${e.description.substring(0,50)}...</p>\n        </div>\n      `),this._markers[e.id]=t})):n.innerHTML="<p>Tidak ada cerita dengan data lokasi untuk ditampilkan di peta.</p>"}setOnStoryItemClick(e){document.querySelector("#story-list").addEventListener("click",t=>{const n=t.target.closest(".story-item--clickable");if(n){const{lat:t,lon:r,id:o}=n.dataset;e({lat:t,lon:r,id:o})}})}setOnSaveClick(e){this._onSaveClick=e}focusMapOnStory({lat:e,lon:t,id:n}){this._map&&this._markers[n]&&(this._map.flyTo([e,t],15),this._markers[n].openPopup())}showError(e){document.querySelector("#story-list").innerHTML=`<p>${e}</p>`}redirectToLogin(){window.location.hash="#/login"}},S=(e,t)=>t.some(t=>e instanceof t);let k,_;const x=new WeakMap,E=new WeakMap,T=new WeakMap;let I={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return x.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return A(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function C(e){I=e(I)}function D(e){return"function"==typeof e?(t=e,(_||(_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(q(this),e),A(this.request)}:function(...e){return A(t.apply(q(this),e))}):(e instanceof IDBTransaction&&function(e){if(x.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",i),e.removeEventListener("abort",i)},o=()=>{t(),r()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",o),e.addEventListener("error",i),e.addEventListener("abort",i)});x.set(e,t)}(e),S(e,k||(k=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,I):e);var t}function A(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",o),e.removeEventListener("error",i)},o=()=>{t(A(e.result)),r()},i=()=>{n(e.error),r()};e.addEventListener("success",o),e.addEventListener("error",i)});return T.set(t,e),t}(e);if(E.has(e))return E.get(e);const t=D(e);return t!==e&&(E.set(e,t),T.set(t,e)),t}const q=e=>T.get(e),M=["get","getKey","getAll","getAllKeys","count"],O=["put","add","delete","clear"],P=new Map;function B(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(P.get(t))return P.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,o=O.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!o&&!M.includes(n))return;const i=async function(e,...t){const i=this.transaction(e,o?"readwrite":"readonly");let a=i.store;return r&&(a=a.index(t.shift())),(await Promise.all([a[n](...t),o&&i.done]))[0]};return P.set(t,i),i}C(e=>({...e,get:(t,n,r)=>B(t,n)||e.get(t,n,r),has:(t,n)=>!!B(t,n)||e.has(t,n)}));const j=["continue","continuePrimaryKey","advance"],$={},N=new WeakMap,H=new WeakMap,R={get(e,t){if(!j.includes(t))return e[t];let n=$[t];return n||(n=$[t]=function(...e){N.set(this,H.get(this)[t](...e))}),n}};async function*U(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;const n=new Proxy(t,R);for(H.set(n,t),T.set(n,q(t));t;)yield n,t=await(N.get(n)||t.continue()),N.delete(n)}function V(e,t){return t===Symbol.asyncIterator&&S(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&S(e,[IDBIndex,IDBObjectStore])}C(e=>({...e,get:(t,n,r)=>V(t,n)?U:e.get(t,n,r),has:(t,n)=>V(t,n)||e.has(t,n)}));const z="stories",F=function(e,t,{blocked:n,upgrade:r,blocking:o,terminated:i}={}){const a=indexedDB.open(e,t),s=A(a);return r&&a.addEventListener("upgradeneeded",e=>{r(A(a.result),e.oldVersion,e.newVersion,A(a.transaction),e)}),n&&a.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),s.then(e=>{i&&e.addEventListener("close",()=>i()),o&&e.addEventListener("versionchange",e=>o(e.oldVersion,e.newVersion,e))}).catch(()=>{}),s}("story-db",1,{upgrade(e){e.objectStoreNames.contains(z)||e.createObjectStore(z,{keyPath:"id"})}}),K=async()=>(await F).getAll(z),W=async e=>(await F).put(z,e),G=class{constructor(e){this._view=new b(e)}async render(){if(w.getAuthToken()){this._view.render(),this._view.setOnStoryItemClick(e=>{this._view.focusMapOnStory(e)}),this._view.setOnSaveClick(async e=>{try{await W(e),alert("Cerita disimpan ke offline!")}catch(e){alert("Gagal menyimpan offline: "+e.message)}});try{const e=await w.getAllStories();this._view.renderStoryList(e),this._view.renderMap(e)}catch(e){const t=await K();t.length>0?(this._view.renderStoryList(t),this._view.renderMap(t)):this._view.showError(`Gagal memuat cerita: ${e.message}. Tidak ada data offline.`),w.removeAuthToken()}}else this._view.redirectToLogin()}},J=class{constructor(e){this._container=e}render(){this._container.innerHTML='<div class="form-container"> <h2>Login</h2> <form id="login-form"> <div class="form-group"> <label for="login-email">Email</label> <input type="email" id="login-email" required> </div> <div class="form-group"> <label for="login-password">Password</label> <input type="password" id="login-password" minlength="8" required> </div> <button type="submit">Login</button> </form> <p>Belum punya akun? <a href="#/register">Daftar di sini</a></p> </div>'}getLoginInput(){return{email:document.querySelector("#login-email").value,password:document.querySelector("#login-password").value}}setOnLoginSubmit(e){document.querySelector("#login-form").addEventListener("submit",t=>{t.preventDefault(),e()})}showSuccess(e){alert(e),window.location.hash="#/home"}showError(e){alert(e)}},Q=class{constructor(e){this._container=e}render(){this._container.innerHTML='<div class="form-container"> <h2>Register</h2> <form id="register-form"> <div class="form-group"> <label for="register-name">Nama</label> <input type="text" id="register-name" required/> </div> <div class="form-group"> <label for="register-email">Email</label> <input type="email" id="register-email" required/> </div> <div class="form-group"> <label for="register-password">Password</label> <input type="password" id="register-password" minlength="8" required/> </div> <button type="submit">Register</button> </form> <p>Sudah punya akun? <a href="#/login">Login di sini</a></p> </div> '}getRegisterInput(){return{name:document.querySelector("#register-name").value,email:document.querySelector("#register-email").value,password:document.querySelector("#register-password").value}}setOnRegisterSubmit(e){document.querySelector("#register-form").addEventListener("submit",t=>{t.preventDefault(),e()})}showSuccess(e){alert(e),window.location.hash="#/login"}showError(e){alert(e)}},X=class{constructor(e){this._container=e,this._stream=null,this._photo=null,this._latitude=null,this._longitude=null}render(){this._container.innerHTML='<div class="add-story-container"> <h2>Tambah Cerita Baru</h2> <form id="add-story-form"> <div class="camera-container"> <video id="camera-feed" autoplay playsinline></video> <canvas id="photo-canvas" class="hidden"></canvas> <img id="photo-preview" class="hidden" alt="Pratinjau gambar yang diambil"> </div> <button type="button" id="capture-button">Ambil Gambar</button> <div class="form-group"> <label for="story-photo">Atau Unggah Foto dari Perangkat</label> <input type="file" id="story-photo" accept="image/*" required/> </div> <div class="form-group"> <label for="story-description">Deskripsi</label> <textarea id="story-description" rows="4" required></textarea> </div> <div class="form-group"> <label>Pilih Lokasi (Klik pada Peta)</label> <div id="map" style="height:300px;width:100%"></div> <input type="text" id="story-location" readonly="readonly" placeholder="Koordinat akan muncul di sini"> </div> <button type="submit">Unggah Cerita</button> </form> </div> ',this._initCamera(),this._initMap()}async _initCamera(){const e=document.querySelector("#camera-feed");try{this._stream=await navigator.mediaDevices.getUserMedia({video:!0}),e.srcObject=this._stream}catch(e){this.showError("Tidak bisa mengakses kamera. Pastikan Anda memberikan izin.")}}_initMap(){const e=L.map("map").setView([-6.2,106.816666],13);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(e);const t=L.marker([-6.2,106.816666]).addTo(e);e.on("click",e=>{const{lat:n,lng:r}=e.latlng;this._latitude=n,this._longitude=r,t.setLatLng(e.latlng),document.querySelector("#story-location").value=`Lat: ${n.toFixed(6)}, Lon: ${r.toFixed(6)}`})}_capturePhoto(){const e=document.querySelector("#camera-feed"),t=document.querySelector("#photo-canvas"),n=document.querySelector("#photo-preview"),r=t.getContext("2d");e.videoWidth&&e.videoHeight?(t.width=e.videoWidth,t.height=e.videoHeight,r.drawImage(e,0,0,t.width,t.height),t.toBlob(e=>{this._photo=e},"image/jpeg"),n.src=t.toDataURL("image/jpeg"),n.classList.remove("hidden"),e.classList.add("hidden"),this._stream&&this._stream.getTracks().forEach(e=>e.stop())):this.showError("Kamera belum siap, coba lagi sebentar.")}getStoryInput(){const e=document.querySelector("#story-description").value.trim(),t=document.querySelector("#story-photo");let n=this._photo;if(t.files&&t.files.length>0&&(n=t.files[0]),!n||!e)return this.showError("Deskripsi dan foto tidak boleh kosong!"),null;const r=new FormData;return r.append("photo",n),r.append("description",e),this._latitude&&this._longitude&&(r.append("lat",this._latitude),r.append("lon",this._longitude)),r}setOnSubmit(e){document.querySelector("#capture-button").addEventListener("click",()=>this._capturePhoto()),document.querySelector("#add-story-form").addEventListener("submit",t=>{t.preventDefault(),e()})}showSuccess(e){alert(e),window.location.hash="#/home"}showError(e){alert(e)}},Y={"/":G,"/home":G,"/login":class{constructor(e){this._view=new J(e)}async render(){this._view.render(),this._view.setOnLoginSubmit(async()=>{try{const{email:e,password:t}=this._view.getLoginInput();await w.login({email:e,password:t}),this._view.showSuccess("Login berhasil!")}catch(e){this._view.showError(`Login gagal: ${e.message}`)}})}},"/register":class{constructor(e){this._view=new Q(e)}async render(){this._view.render(),this._view.setOnRegisterSubmit(async()=>{try{const e=this._view.getRegisterInput();await w.register(e),this._view.showSuccess("Registrasi berhasil! Silakan login.")}catch(e){this._view.showError(`Registrasi gagal: ${e.message}`)}})}},"/add-story":class{constructor(e){this._view=new X(e)}async render(){this._view.render(),this._view.setOnSubmit(async()=>{const e=this._view.getStoryInput();if(e)try{await w.addNewStory(e),this._view.showSuccess("Cerita berhasil diunggah!")}catch(e){this._view.showError(`Gagal mengunggah cerita: ${e.message}`)}})}}},Z=new class{constructor(e,t){this._mainContent=e,this._routes=t}async renderPage(){const e=location.hash.slice(1).toLowerCase()||"/",t=this._routes[e]||this._routes["/"],n=async()=>{if(t){const e=new t(this._mainContent);await e.render()}else this._mainContent.innerHTML="<p>Halaman tidak ditemukan.</p>"};document.startViewTransition?document.startViewTransition(()=>{n()}):await n()}}(document.querySelector("#main-content"),Y);function ee(){const e=localStorage.getItem("authToken"),t=document.querySelector('a[href="#/login"]'),n=document.querySelector("#logout-btn");t&&n&&(e?(t.style.display="none",n.style.display="inline-block"):(t.style.display="inline-block",n.style.display="none"))}let te;document.addEventListener("click",e=>{e.target&&"logout-btn"===e.target.id&&(localStorage.removeItem("authToken"),window.location.hash="#/login",ee())});const ne=document.querySelector("#install-btn");window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),te=e,ne&&(ne.style.display="inline-block")}),ne&&ne.addEventListener("click",async()=>{ne.style.display="none",te&&(te.prompt(),await te.userChoice,te=null)}),window.addEventListener("hashchange",()=>{Z.renderPage(),ee()}),window.addEventListener("load",()=>{Z.renderPage(),ee(),"Notification"in window&&"default"===Notification.permission&&Notification.requestPermission().catch(()=>{})})})();