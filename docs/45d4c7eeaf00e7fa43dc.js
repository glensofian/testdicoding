import"../styles/main.css";import Router from"../utils/router";import HomePresenter from"../presenters/home-presenter";import LoginPresenter from"../presenters/login-presenter";import RegisterPresenter from"../presenters/register-presenter";import AddStoryPresenter from"../presenters/add-story-presenter";const routes={"/":HomePresenter,"/home":HomePresenter,"/login":LoginPresenter,"/register":RegisterPresenter,"/add-story":AddStoryPresenter},router=new Router(document.querySelector("#main-content"),routes);function updateNavbar(){const e=localStorage.getItem("authToken"),t=document.querySelector('a[href="#/login"]'),r=document.querySelector("#logout-btn");t&&r&&(e?(t.style.display="none",r.style.display="inline-block"):(t.style.display="inline-block",r.style.display="none"))}let deferredPrompt;document.addEventListener("click",e=>{e.target&&"logout-btn"===e.target.id&&(localStorage.removeItem("authToken"),window.location.hash="#/login",updateNavbar())});const installBtn=document.querySelector("#install-btn");window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),deferredPrompt=e,installBtn&&(installBtn.style.display="inline-block")}),installBtn&&installBtn.addEventListener("click",async()=>{installBtn.style.display="none",deferredPrompt&&(deferredPrompt.prompt(),await deferredPrompt.userChoice,deferredPrompt=null)}),window.addEventListener("hashchange",()=>{router.renderPage(),updateNavbar()}),window.addEventListener("load",()=>{router.renderPage(),updateNavbar(),"Notification"in window&&"default"===Notification.permission&&Notification.requestPermission().catch(()=>{})});