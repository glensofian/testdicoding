const CACHE_NAME="story-app-v3",URLS_TO_CACHE=["/","/index.html","/manifest.webmanifest","/src/styles/main.css","/src/views/main.js","/icons/icon-192x192.png","/icons/icon-512x512.png"];self.addEventListener("install",e=>{e.waitUntil(caches.open(CACHE_NAME).then(e=>e.addAll(URLS_TO_CACHE))),self.skipWaiting()}),self.addEventListener("activate",e=>{e.waitUntil(caches.keys().then(e=>Promise.all(e.map(e=>e!==CACHE_NAME?caches.delete(e):Promise.resolve())))),self.clients.claim()}),self.addEventListener("fetch",e=>{const{request:t}=e;t.url.includes("/v1/stories")||t.url.includes("/v1/login")||t.url.includes("/v1/register")?e.respondWith(fetch(t).catch(()=>caches.match(t))):e.respondWith(caches.match(t).then(e=>e||fetch(t)))}),self.addEventListener("push",e=>{const t=e.data?e.data.json():{},i=t.title||"Story App",n={body:t.body||"Ada cerita baru!",icon:"/icons/icon-192x192.png",badge:"/icons/icon-192x192.png",data:{url:t.url||"/#/home"},actions:[{action:"open",title:"Lihat Cerita"}]};e.waitUntil(self.registration.showNotification(i,n))}),self.addEventListener("notificationclick",e=>{e.notification.close();const t=e.notification?.data?.url||"/#/home";e.waitUntil(clients.openWindow(t))});